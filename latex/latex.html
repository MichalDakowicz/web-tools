<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>LaTeX OCR Tool</title>
        <link rel="stylesheet" href="../style.css" />
        <link rel="stylesheet" href="latex.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.7/es6-shim.min.js"></script>
        <script>
            window.MathJax = {
                tex: {
                    inlineMath: [
                        ["$", "$"],
                        ["\\(", "\\)"],
                    ],
                    displayMath: [
                        ["$$", "$$"],
                        ["\\[", "\\]"],
                    ],
                    processEscapes: true,
                },
                options: {
                    enableMenu: false,
                },
                startup: {
                    pageReady: function () {
                        return MathJax.startup
                            .defaultPageReady()
                            .then(function () {
                                console.log(
                                    "MathJax initial typesetting complete"
                                );
                            });
                    },
                },
            };
        </script>
        <script
            id="MathJax-script"
            async
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"
        ></script>
    </head>
    <body>
        <div class="container">
            <h1>LaTeX OCR Tool</h1>
            <p class="description">
                Upload an image containing mathematical formulas to convert to
                LaTeX
            </p>

            <div class="input-section">
                <div class="custom-file-input">
                    <input
                        type="file"
                        name="imageInput"
                        id="imageInput"
                        class="file-input-hidden"
                        aria-label="Image input"
                        accept="image/*"
                    />
                    <div
                        class="file-input-wrapper"
                        role="button"
                        tabindex="0"
                        aria-label="File input area"
                    >
                        <div class="file-input-content">
                            <svg
                                class="upload-icon"
                                viewBox="0 0 24 24"
                                aria-hidden="true"
                            >
                                <path
                                    d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"
                                />
                            </svg>
                            <span class="file-input-text" id="fileInputText">
                                Drop your image here or click to browse
                            </span>
                            <span class="file-input-subtext">
                                Supported formats: JPG, PNG, GIF, BMP
                            </span>
                        </div>
                    </div>
                </div>

                <div class="api-key-section">
                    <label for="apiKey">Mathpix API Key (required):</label>
                    <input
                        type="password"
                        id="apiKey"
                        placeholder="Enter your Mathpix API key"
                    />
                    <p class="api-info">
                        Don't have an API key?
                        <a href="https://mathpix.com/" target="_blank"
                            >Sign up at Mathpix</a
                        >
                    </p>
                </div>

                <button id="processBtn" disabled>Recognize LaTeX</button>

                <div id="loading" class="loading-spinner hidden"></div>
            </div>

            <div class="output-section">
                <div class="preview-section">
                    <h3>Image Preview</h3>
                    <div
                        id="imagePreview"
                        class="image-preview-container"
                    ></div>
                </div>

                <div class="result-section">
                    <h3>LaTeX Output</h3>
                    <div class="latex-output-container">
                        <textarea
                            id="latexOutput"
                            placeholder="LaTeX will appear here..."
                            readonly
                        ></textarea>
                        <button id="copyBtn" class="copy-button" disabled>
                            <span class="copy-text">Copy LaTeX</span>
                        </button>
                    </div>

                    <div class="rendered-preview">
                        <h3>Rendered Preview</h3>
                        <div id="mathPreview" class="math-preview"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="darkMode">
            <input
                type="checkbox"
                id="dark-mode-toggle"
                aria-label="Toggle dark mode"
            />
            <label for="dark-mode-toggle" style="cursor: pointer"
                ><b>Dark Mode</b></label
            >
        </div>

        <a href="../index.html" class="home-button">
            <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
            </svg>
        </a>

        <script src="../script.js"></script>
        <script src="latex.js"></script>
    </body>
</html>
